<!-- templates/news/search.html -->
{% extends 'base.html' %}
{% block title %}搜索 "{{ keyword }}" - 直播电商选品系统{% endblock %}

{% block content %}
<div class="container">
  <div class="row mb-4">
    <div class="col-md-8">
      <h2><i class="bi bi-search"></i> "{{ keyword }}" 的搜索结果</h2>
      <p class="lead">找到 {{ count }} 个相关商品</p>
    </div>
    <div class="col-md-4">
      <form action="{{ url_for('news.search') }}" method="get">
        <div class="input-group">
          <input type="text" name="keyword" value="{{ keyword }}" 
                 class="form-control" placeholder="搜索商品...">
          <button class="btn btn-primary" type="submit">
            <i class="bi bi-search"></i>
          </button>
        </div>
      </form>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      {% if products %}
        {% for product in products %}
        <div class="card mb-3 shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-md-3">
                <img src="https://via.placeholder.com/150x100?text=Product" 
                     class="img-fluid rounded" alt="{{ product.title }}">
              </div>
              <div class="col-md-6">
                <h5 class="card-title">
                  {{ product.title|replace(keyword, '<span class="text-danger">' + keyword + '</span>')|safe }}
                </h5>
                <p class="card-text text-muted small">
                  {{ product.content|replace(keyword, '<span class="text-danger">' + keyword + '</span>')|safe }}
                </p>
                <div class="d-flex gap-2 small">
                  <span class="badge bg-primary">{{ product.category }}</span>
                  <span class="text-muted">{{ product.supplier }}</span>
                </div>
              </div>
              <div class="col-md-3 text-end">
                <div class="h5 text-primary">¥{{ "%.2f"|format(product.price) }}</div>
                <a href="{{ url_for('news.detail', product_id=product.id) }}" 
                   class="btn btn-sm btn-outline-primary">查看详情</a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="alert alert-info">
          <i class="bi bi-info-circle"></i> 未找到与 "{{ keyword }}" 相关的商品
        </div>
      {% endif %}
    </div>

    <div class="col-md-4">
      <!-- 搜索提示 -->
      <div class="card shadow mb-4">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-lightbulb"></i> 搜索技巧</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li class="mb-2"><i class="bi bi-check2-circle me-2"></i>尝试商品分类名称</li>
            <li class="mb-2"><i class="bi bi-check2-circle me-2"></i>使用供应商品牌名称</li>
            <li><i class="bi bi-check2-circle me-2"></i>组合关键词如 "耳机 无线"</li>
          </ul>
        </div>
      </div>

      <!-- 热门搜索 -->
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-fire"></i> 热搜榜单</h5>
        </div>
        <div class="card-body">
          <div class="d-flex flex-wrap gap-2">
            <a href="?keyword=耳机" class="badge bg-secondary">蓝牙耳机</a>
            <a href="?keyword=智能" class="badge bg-secondary">智能设备</a>
            <a href="?keyword=美妆" class="badge bg-secondary">美妆个护</a>
            <a href="?keyword=厨房" class="badge bg-secondary">厨房电器</a>
            <a href="?keyword=健身" class="badge bg-secondary">健身器材</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}