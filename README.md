# 豆粕期货价格预测系统

## 项目简介

豆粕期货价格预测系统是一个基于深度学习技术的应用程序，旨在通过分析历史数据和市场因素，为用户提供豆粕期货价格的预测分析。本系统结合了多种深度学习模型，包括多层感知机（MLP）、长短期记忆网络（LSTM）和卷积神经网络（CNN），以提供更准确的价格预测。

## 功能特点

- **数据可视化**：直观展示豆粕期货历史价格走势和交易量
- **价格预测**：使用三种不同的深度学习模型进行未来价格预测
- **新闻资讯**：提供最新的市场动态、政策法规和行业分析
- **论坛讨论**：用户可以交流经验，分享市场见解
- **模型评估**：管理员可以查看和评估模型性能指标
- **用户管理**：支持管理员和普通用户两种角色，权限分离

## 系统架构

本系统采用Flask框架开发，主要包括以下组件：

- **前端**：HTML, CSS, JavaScript, Bootstrap 5
- **后端**：Python, Flask
- **数据库**：SQLite
- **深度学习框架**：TensorFlow

## 模型架构详解

本系统使用了三种不同的深度学习模型进行价格预测，下面将详细介绍每种模型的架构。

### 1. 多层感知机 (MLP) 模型

多层感知机是一种前馈神经网络，由多层全连接层组成。我们的MLP模型采用了增强型设计，特别适合处理豆粕期货价格的非线性关系。

#### 架构特点：

1. **多分支特征提取**：

   - 使用不同尺度的卷积层提取短期、中期和长期特征
   - 全局特征通过扁平化处理直接提取
   - 所有特征通过连接层合并，提供全面的数据视角

2. **残差连接**：

   - 引入残差连接避免深层网络的梯度消失问题
   - 帮助模型更好地学习复杂的价格模式

3. **正则化技术**：

   - 批归一化层：加速训练并提高稳定性
   - Dropout层：减少过拟合风险
   - L2正则化：提高模型泛化能力

4. **激活函数**：
   - 使用PReLU（参数化ReLU）激活函数，增强非线性表达能力
   - 相比传统ReLU，PReLU可以学习负值区域的斜率，提高模型表现

#### 模型参数：

- 第一隐藏层：512个神经元
- 第二隐藏层：256个神经元
- 第三隐藏层：128个神经元
- 第四隐藏层：64个神经元
- Dropout率：0.3
- 学习率：0.001
- L2正则化系数：0.001

#### 优势：

- 计算效率高，训练速度快
- 能够有效捕捉价格变动模式
- 模型结构简单，易于理解和调整

#### 局限性：

- 对时间序列的长期依赖关系捕捉能力有限
- 需要更多特征工程来提高性能

### 2. 长短期记忆网络 (LSTM) 模型

LSTM是一种特殊的循环神经网络，专门设计用于处理序列数据和时间序列预测。我们的LSTM模型采用了双向设计，能够更好地捕捉时间序列数据中的长期依赖关系。

#### 架构特点：

1. **双向LSTM层**：

   - 同时考虑过去和未来的信息
   - 第一层返回完整序列，第二层返回最终状态
   - 增强对长期依赖关系的建模能力

2. **注意力机制**：

   - 在LSTM层之间添加注意力层
   - 帮助模型关注最相关的时间步
   - 提高对关键价格变动点的敏感度

3. **批归一化和正则化**：

   - 每个主要层后都添加批归一化
   - 使用L2正则化减少过拟合
   - 适度的Dropout提高泛化能力

4. **后端全连接网络**：
   - 多层全连接网络处理LSTM提取的特征
   - 使用PReLU激活函数增强非线性表达

#### 模型参数：

- 第一LSTM层：256个单元
- 第二LSTM层：128个单元
- 第一全连接层：128个神经元
- 第二全连接层：64个神经元
- Dropout率：0.3
- 学习率：0.001
- L2正则化系数：0.001

#### 优势：

- 优秀的时间序列建模能力
- 能够记忆长期价格趋势
- 对序列数据的依赖关系有很好的理解

#### 局限性：

- 训练时间较长
- 计算资源需求较高
- 容易出现过拟合问题

### 3. 卷积神经网络 (CNN) 模型

CNN通常用于图像处理，但在时间序列预测中也表现出色。我们的CNN模型采用了多分支设计，专门用于提取时间序列数据中的局部特征和模式。

#### 架构特点：

1. **多分支卷积结构**：

   - 使用不同大小的卷积核（2、3、5）捕捉不同尺度的模式
   - 每个分支独立提取特征，然后合并
   - 增强对不同时间跨度模式的识别能力

2. **特征精炼层**：

   - 合并分支后添加额外卷积层
   - 使用最大池化减少特征维度
   - 全局平均池化提取最重要的特征

3. **正则化技术**：

   - 批归一化层稳定训练过程
   - Dropout防止过拟合
   - L2正则化增强泛化能力

4. **后端全连接网络**：
   - 多层全连接网络进一步处理提取的特征
   - ReLU激活函数在GPU上更高效

#### 模型参数：

- 卷积层滤波器数量：128/64/32
- 卷积核大小：2/3/5
- 池化大小：2
- 全连接层：64/32个神经元
- Dropout率：0.15
- 学习率：0.0008
- L2正则化系数：0.0001

#### 优势：

- 能够有效捕捉局部时间模式
- 参数数量少于LSTM，训练更快
- 对噪声数据有较好的鲁棒性

#### 局限性：

- 对全局长期依赖关系的建模能力不如LSTM
- 需要精心设计的卷积结构

## 模型性能比较

根据我们的测试，三种模型在豆粕期货价格预测上的性能如下：

| 模型 | 准确率 | RMSE   | MAE   | R²    |
| ---- | ------ | ------ | ----- | ----- |
| MLP  | 97.52% | 67.66  | 53.96 | 0.929 |
| LSTM | 97.34% | 144.14 | 68.23 | 0.912 |
| CNN  | 97.25% | 127.27 | 65.18 | 0.918 |

注：RMSE（均方根误差）越低越好，MAE（平均绝对误差）越低越好，R²（决定系数）越接近1越好。

## 安装与使用

### 环境要求

- Python 3.8+
- TensorFlow 2.9.0+
- Flask 2.0.0+
- 其他依赖见requirements.txt

### 安装步骤

1. 克隆仓库
2. 安装依赖：`pip install -r requirements.txt`
3. 运行应用：`python app.py`

## 使用说明

1. 打开网站 → 登录界面 → 选择用户类型 → 登录 → 显示页面
2. 在数据可视化页面可以查看历史数据和预测结果
3. 在新闻资讯页面可以浏览最新市场动态
4. 在论坛讨论页面可以与其他用户交流经验

## 注意事项

- 预测结果仅供参考，不构成投资建议
- 管理员账户拥有上传数据和访问模型评估功能的权限
- 系统默认使用`model_data/date1.csv`作为数据集

## 贡献与反馈

欢迎提交问题和改进建议，共同完善本系统！
